import java.nio.file.*;
dependencies {
    compile 'org.apache.tomcat.embed:tomcat-embed-core:7.0.57'
    compile 'org.apache.tomcat.embed:tomcat-embed-logging-juli:7.0.57'
    compile 'org.apache.tomcat.embed:tomcat-embed-jasper:7.0.57'
    compile project(":varOne-web")
}
jar {
    manifest {
       attributes 'Main-Class': 'com.varone.exec.TomcatServer'
    }

}
task copyToLib(){
    doLast{
        configurations.compile.copy().allDependencies.each { dep ->
             String directory = "$buildDir/lib"
             if(!new File(directory).exists()){
                  new File(directory).mkdirs()
             }
             configurations.compile.each { File path ->
                  String dstJarFilePath = directory + "/" + path.name
                  if((path.name.contains('jersey') || path.name.contains('tomcat')) && !new File(dstJarFilePath).exists()){
                      Files.copy(path.toPath(), FileSystems.getDefault().getPath(dstJarFilePath))
                  }
		  if(path.name.contains('asm')  && !new File(dstJarFilePath).exists()){
		      Files.copy(path.toPath(), FileSystems.getDefault().getPath(dstJarFilePath))

                  }
             }
        }
    }
}
jar.dependsOn('copyToLib')
